<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xml:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5" xmlns:sec="http://www.w3.org/1999/xhtml">>
<head>
    <script th:src="@{/assets/js/jquery.min.js}"></script>
    <script th:src="@{/assets/js/layer.js}"></script>
    <link rel="stylesheet" href="../../static/assets/css/favor.css" th:href="@{/assets/css/favor.css}">
</head>
<div th:replace="client/header::header(${article.title},null)"></div>
<body>
<article class="main-content post-page">
    <div class="post-header">
        <h1 class="post-title" itemprop="name headline" th:text="${article.title}"></h1>
        <div class="post-data">
            <time th:datetime="${commons.dateFormat(article.created)}" itemprop="datePublished" th:text="'发布于 '+ ${commons.dateFormat(article.created)}"></time>
        </div>
    </div>
    <br />
    <div id="post-content" class="post-content content" th:utext="${commons.article(article.content)}"></div>
    <div style="text-align: right" sec:authorize="isAuthenticated()">
<!--        设置了只有登录才有点赞的选项出现-->
        <div class="likeIcon-wrap">
            <div class="like-icon" data-key="on"></div>
            <div class="like-num">1</div>
        </div>
    </div>
</article>
<div th:replace="client/comments::comments"></div>
<div th:replace="client/footer::footer"></div>
<!-- 使用layer.js实现图片缩放功能 -->
<script type="text/JavaScript">
    $('.post-content img').on('click', function(){
        var imgurl=$(this).attr('src');
        var w=this.width*2;
        var h=this.height*2+50;
        layer.open({
            type: 1,
            title: false, //不显示标题栏
            area: [w+"px", h+"px"],
            shadeClose: true, //点击遮罩关闭
            content: '\<\div style="padding:20px;">' +
                    '\<\img style="width:'+(w-50)+'px;" src='+imgurl+'\>\<\/div>'
        });
    });

    $(document).ready(function () {
        // likeClickCount
        $(".like-icon").on('click', function () {
            likeClickCount();
        })
    })
    // likeClickCount
    function likeClickCount() {
    //Number函数将对象的值转换成数字
        var like_num = Number($('.like-num').html());
        if ($('.like-icon').attr('data-key') == 'on') {
            $('.like-icon').addClass('on');
            // like-num add
            like_num = like_num + 1;
            $('.like-num').html(like_num);
            $('.like-icon').attr('data-key', '');
        } else {
            $('.like-icon').removeClass('on');
            like_num = like_num - 1;
            $('.like-num').html(like_num);
            $('.like-icon').attr('data-key', 'on');
        }
    }
</script>
</body>
</html>